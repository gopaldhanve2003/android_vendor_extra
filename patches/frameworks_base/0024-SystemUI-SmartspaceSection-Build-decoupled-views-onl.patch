From 72e6f87123f1f73e5c06a53b9597981876b6c49a Mon Sep 17 00:00:00 2001
From: Pranav Vashi <neobuddy89@gmail.com>
Date: Sun, 5 Jan 2025 08:58:43 +0530
Subject: [PATCH 24/28] SystemUI: SmartspaceSection: Build decoupled views only
 when required

Signed-off-by: Pranav Vashi <neobuddy89@gmail.com>
---
 .../keyguard/ui/view/layout/sections/SmartspaceSection.kt   | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/packages/SystemUI/src/com/android/systemui/keyguard/ui/view/layout/sections/SmartspaceSection.kt b/packages/SystemUI/src/com/android/systemui/keyguard/ui/view/layout/sections/SmartspaceSection.kt
index 73e14b1524f3..46027f9aa185 100644
--- a/packages/SystemUI/src/com/android/systemui/keyguard/ui/view/layout/sections/SmartspaceSection.kt
+++ b/packages/SystemUI/src/com/android/systemui/keyguard/ui/view/layout/sections/SmartspaceSection.kt
@@ -73,12 +73,12 @@ constructor(
         if (!MigrateClocksToBlueprint.isEnabled) return
         if (!keyguardSmartspaceViewModel.isSmartspaceEnabled) return
         smartspaceView = smartspaceController.buildAndConnectView(constraintLayout)
-        weatherView = smartspaceController.buildAndConnectWeatherView(constraintLayout)
-        dateWeatherView =
-            smartspaceController.buildAndConnectDateView(constraintLayout) as ViewGroup
         pastVisibility = smartspaceView?.visibility ?: View.GONE
         constraintLayout.addView(smartspaceView)
         if (keyguardSmartspaceViewModel.isDateWeatherDecoupled) {
+            dateWeatherView =
+                smartspaceController.buildAndConnectDateView(constraintLayout) as ViewGroup
+            weatherView = smartspaceController.buildAndConnectWeatherView(constraintLayout)
             constraintLayout.addView(dateWeatherView)
             // Place weather right after the date, before the extras (alarm and dnd)
             val index = if (dateWeatherView?.childCount == 0) 0 else 1
-- 
2.49.0

